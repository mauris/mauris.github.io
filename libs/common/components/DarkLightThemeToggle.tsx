import { MouseEventHandler } from 'react';
import { useTheme } from 'next-themes';
import { useIsMounted } from '../hooks/useIsMounted';

const themeIconChoices = {
  system: <AutomaticIcon />,
  light: <SunIcon />,
  dark: <MoonIcon />,
} as const;
type ThemeChoice = keyof typeof themeIconChoices;
const toggleChoices = Object.keys(themeIconChoices) as ThemeChoice[];

export function DarkLightThemeToggle() {
  const { theme, setTheme } = useTheme();
  const mounted = useIsMounted();

  if (!mounted) {
    return null;
  }

  const toggleTheme: MouseEventHandler = (e) => {
    e.preventDefault();
    let currentIdx = theme ? toggleChoices.indexOf(theme as ThemeChoice) : 0;
    if (currentIdx === toggleChoices.length - 1) {
      currentIdx = -1;
    }
    currentIdx += 1;
    setTheme(toggleChoices[currentIdx]);
  };

  return (
    <a
      title={theme === 'system' ? 'Currently based on system theme: click to set theme' : 'Toggle theme'}
      className="cursor-pointer select-none"
      onClick={toggleTheme}
    >
      {theme && theme in themeIconChoices ? themeIconChoices[theme as ThemeChoice] : themeIconChoices.light}
    </a>
  );
}

function MoonIcon() {
  return (
    <svg
      className="text-slate-800 hover:text-sky-600 dark:text-white hover:dark:text-sky-300 transition-all duration-300 inline"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
      width="24px"
      height="24px"
      viewBox="0 0 24 24"
      version="1.1"
    >
      <path d="M 12.910156 23.46875 C 6.582031 23.46875 1.4375 18.324219 1.4375 12 C 1.4375 5.675781 6.585938 0.53125 12.910156 0.53125 C 13.292969 0.53125 13.679688 0.546875 14.0625 0.585938 C 14.398438 0.617188 14.695312 0.828125 14.835938 1.132812 C 14.976562 1.4375 14.949219 1.800781 14.761719 2.082031 C 13.683594 3.664062 13.109375 5.515625 13.109375 7.433594 C 13.109375 12.355469 16.800781 16.445312 21.699219 16.929688 C 22.035156 16.964844 22.332031 17.175781 22.472656 17.480469 C 22.617188 17.785156 22.585938 18.144531 22.398438 18.425781 C 20.25 21.585938 16.707031 23.46875 12.910156 23.46875 Z M 12.324219 2.46875 C 7.332031 2.773438 3.359375 6.933594 3.359375 12 C 3.359375 17.265625 7.644531 21.546875 12.910156 21.546875 C 15.554688 21.546875 18.046875 20.453125 19.835938 18.5625 C 17.671875 18.015625 15.707031 16.835938 14.175781 15.160156 C 12.25 13.039062 11.183594 10.304688 11.183594 7.445312 C 11.1875 5.703125 11.578125 4.011719 12.324219 2.46875 Z M 12.324219 2.46875 " />
    </svg>
  );
}

function SunIcon() {
  return (
    <svg
      className="text-slate-800 hover:text-sky-600 dark:text-white hover:dark:text-sky-300 transition-all duration-300 inline"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
      width="24px"
      height="24px"
      viewBox="0 0 24 24"
      version="1.1"
    >
      <path d="M 12 5.105469 C 8.199219 5.105469 5.105469 8.199219 5.105469 12 C 5.105469 15.800781 8.199219 18.894531 12 18.894531 C 15.800781 18.894531 18.894531 15.800781 18.894531 12 C 18.894531 8.199219 15.800781 5.105469 12 5.105469 Z M 12 17.363281 C 9.042969 17.363281 6.636719 14.957031 6.636719 12 C 6.636719 9.042969 9.042969 6.636719 12 6.636719 C 14.957031 6.636719 17.363281 9.042969 17.363281 12 C 17.363281 14.957031 14.957031 17.363281 12 17.363281 Z M 12 17.363281 " />
      <path d="M 12 3.921875 C 12.421875 3.921875 12.765625 3.582031 12.765625 3.15625 L 12.765625 0.765625 C 12.765625 0.34375 12.421875 0 12 0 C 11.578125 0 11.234375 0.34375 11.234375 0.765625 L 11.234375 3.15625 C 11.234375 3.582031 11.578125 3.921875 12 3.921875 Z M 12 3.921875 " />
      <path d="M 12 20.078125 C 11.578125 20.078125 11.234375 20.417969 11.234375 20.84375 L 11.234375 23.234375 C 11.234375 23.65625 11.578125 24 12 24 C 12.421875 24 12.765625 23.65625 12.765625 23.234375 L 12.765625 20.84375 C 12.765625 20.417969 12.421875 20.078125 12 20.078125 Z M 12 20.078125 " />
      <path d="M 5.207031 6.289062 C 5.503906 6.589844 5.988281 6.589844 6.289062 6.289062 C 6.589844 5.988281 6.589844 5.503906 6.289062 5.207031 L 4.597656 3.515625 C 4.300781 3.214844 3.8125 3.214844 3.515625 3.515625 C 3.214844 3.8125 3.214844 4.296875 3.515625 4.597656 Z M 5.207031 6.289062 " />
      <path d="M 18.792969 17.710938 C 18.496094 17.410156 18.011719 17.410156 17.710938 17.710938 C 17.410156 18.011719 17.410156 18.496094 17.710938 18.792969 L 19.402344 20.484375 C 19.699219 20.785156 20.1875 20.785156 20.484375 20.484375 C 20.785156 20.1875 20.785156 19.703125 20.484375 19.402344 Z M 18.792969 17.710938 " />
      <path d="M 3.921875 12 C 3.921875 11.578125 3.582031 11.234375 3.15625 11.234375 L 0.765625 11.234375 C 0.34375 11.234375 0 11.578125 0 12 C 0 12.421875 0.34375 12.765625 0.765625 12.765625 L 3.15625 12.765625 C 3.582031 12.765625 3.921875 12.421875 3.921875 12 Z M 3.921875 12 " />
      <path d="M 23.234375 11.234375 L 20.84375 11.234375 C 20.417969 11.234375 20.078125 11.578125 20.078125 12 C 20.078125 12.421875 20.417969 12.765625 20.84375 12.765625 L 23.234375 12.765625 C 23.65625 12.765625 24 12.421875 24 12 C 24 11.578125 23.65625 11.234375 23.234375 11.234375 Z M 23.234375 11.234375 " />
      <path d="M 5.207031 17.710938 L 3.515625 19.402344 C 3.214844 19.703125 3.214844 20.1875 3.515625 20.484375 C 3.8125 20.785156 4.296875 20.785156 4.597656 20.484375 L 6.289062 18.792969 C 6.589844 18.496094 6.589844 18.011719 6.289062 17.710938 C 5.988281 17.410156 5.503906 17.410156 5.207031 17.710938 Z M 5.207031 17.710938 " />
      <path d="M 18.792969 6.289062 L 20.484375 4.597656 C 20.785156 4.296875 20.785156 3.8125 20.484375 3.515625 C 20.1875 3.214844 19.703125 3.214844 19.402344 3.515625 L 17.710938 5.207031 C 17.410156 5.503906 17.410156 5.988281 17.710938 6.289062 C 18.011719 6.589844 18.496094 6.589844 18.792969 6.289062 Z M 18.792969 6.289062 " />
    </svg>
  );
}

function AutomaticIcon() {
  return (
    <svg
      className="text-slate-800 hover:text-sky-600 dark:text-white hover:dark:text-sky-300 transition-all duration-300 inline"
      xmlns="http://www.w3.org/2000/svg"
      id="svg"
      version="1.1"
      width="24px"
      height="24px"
      viewBox="0, 0, 400,400"
      fill="currentColor"
    >
      <path
        d="M180.898 33.756 C 53.423 48.339,-10.842 197.511,66.165 300.073 C 98.308 342.882,156.414 371.151,204.130 367.195 C 212.293 366.518,212.107 366.991,208.179 356.876 C 206.321 352.091,204.154 344.662,203.362 340.367 C 202.571 336.072,201.491 332.558,200.962 332.558 C 200.433 332.558,200.000 272.829,200.000 199.826 L 200.000 67.094 210.189 67.817 C 274.691 72.395,327.993 126.144,332.168 190.818 L 332.889 201.985 340.533 203.393 C 344.737 204.168,352.096 206.324,356.887 208.184 C 367.847 212.440,367.759 212.564,366.982 193.998 C 362.887 96.263,277.470 22.707,180.898 33.756 M300.136 234.629 C 299.527 235.768,298.663 240.411,298.215 244.948 L 297.403 253.197 291.902 255.683 C 288.877 257.050,283.940 259.799,280.932 261.792 L 275.462 265.414 268.053 262.266 C 256.855 257.506,256.567 257.671,246.794 274.419 C 236.848 291.464,236.829 291.999,245.930 298.832 L 252.907 304.070 252.778 316.761 L 252.649 329.452 246.095 334.203 C 236.759 340.970,236.772 341.478,246.758 358.887 C 256.616 376.072,256.506 376.009,268.041 371.088 L 276.083 367.658 279.364 370.418 C 281.168 371.936,285.964 374.763,290.022 376.699 L 297.400 380.220 298.196 388.713 C 299.330 400.819,297.931 400.107,319.854 399.739 L 338.953 399.419 339.913 393.605 C 340.440 390.407,341.119 386.085,341.421 384.001 C 341.890 380.762,342.934 379.717,348.601 376.814 C 352.248 374.945,357.049 372.146,359.269 370.593 L 363.305 367.770 370.714 371.094 C 382.595 376.425,381.912 376.831,392.829 357.939 C 401.944 342.165,401.959 340.936,393.121 334.590 L 386.242 329.651 386.234 316.707 L 386.225 303.762 393.113 298.772 C 402.033 292.310,401.988 291.486,391.718 273.670 C 382.256 257.254,382.554 257.413,370.509 262.359 L 363.065 265.417 357.656 261.695 C 354.682 259.649,349.911 256.941,347.054 255.677 C 344.198 254.413,341.850 253.012,341.837 252.562 C 341.710 248.037,339.206 235.307,338.206 234.102 C 336.002 231.447,301.585 231.923,300.136 234.629 M328.050 289.555 C 338.533 292.467,347.612 304.854,347.638 316.279 C 347.702 345.393,308.876 355.948,295.064 330.571 C 282.669 307.797,302.946 282.582,328.050 289.555 "
        fillRule="evenodd"
      />
    </svg>
  );
}
